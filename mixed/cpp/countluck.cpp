/*input
9
37 31
X.XXXX.XX....X.XX...X.XXXXXXXXX
X.XXX...XXX.X..XXX.XX..XXXXXXXX
...X.XX..X...X..XX.X..XXXXXXXXX
X.X..X..X.X.X..X.....XX.XXXXXXX
...X..X.X....X.X.X.X.X..XXXXXXX
.X..X....X.X.....XX....XXXXXXXX
..X..XX.X.X..XX.X..XX.XXXXXXXXX
.XXX.X.....X.X.X*.X.XX.XXXXXXXX
X..X..X.X.X.....X....X..XXXXXXX
..X.X....X..XXXX..XXX..XXXXXXXX
X....XXX..X.....X...X.XXXXXXXXX
..XX.....X.X.X.X..X.X..XXXXXXXX
XX.X.X.X...X.XX.X..X..X..XXXXXX
.M...XXXX.X.....X.X.X...XXXXXXX
X.XXX..X...X.X.X..X..X.XXXXXXXX
.XX...X.XX..X..X.X.X....XXXXXXX
....X......X..X......XXX.XXXXXX
X.X.XX.XXX..X.X.XX.XX.....XXXXX
X..X..X....XX.....X...X.X..XXXX
..X.X...XX....X.XX..X.X..XX.XXX
.X..X.X.X.X.XX...X.X.X.XX...XXX
XX.X...X....X..X........XX.X.XX
.....XX..X.X.XX..XX.X.X......XX
X.X.XX..X.XX....X..XXXXX.XXXX.X
XX..X.XX....XXX...X.X.X........
.XXXX...XXX.....X......XX.XX.XX
......XX....X.X..XX.XX...XX.XXX
X.X.X....X.X...X...X...X.....X.
XX...X.X..X..X.XXXX.XX.X.X.X...
XXXX..X..XXX.X......X.X...X..XX
XXX..XXX..X..XX.X.X....XX..X..X
X.XX..XX.X..X...X..X.X.XX.X..XX
...XXXX..X.X..X..X..XXX...XXXXX
XX...X..XX.XX..X..X.XX..X..XXXX
XX.XX..XXXXX.X.X.X...X.XXXXXXXX
X.....X.XXX..X.X..X.XXXXXXXXXXX
..X.X......X...X.X..XXXXXXXXXXX
20
3 41
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
M.......................................*
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
20
5 11
..........*
.XXXXXXXXXX
...........
XXXXXXXXXX.
M..........
0
4 11
.X.X......X
.X*.X.XXX.X
.XX.X.XM...
......XXXX.
4
4 11
.X.X......X
.X*.X.XXX.X
.XX.X.XM...
......XXXX.
40
5 17
XXXXXXXXXXXXXXXXX
XXX.XX.XXXXXXXXXX
XX.*..M.XXXXXXXXX
XXX.XX.XXXXXXXXXX
XXXXXXXXXXXXXXXXX
1
41 41
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
M........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.*.......................................
280
41 41
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
M........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.*.......................................
281
41 41
.X.XXXXXXXXXXXXXXXXXXX.X.X.X.X.X.X.X.X.X.
...XXXXXXXXXXXXXXXXXXX...................
.X..X.X.X.X.X.X.X..XXXX*X.X.X.X.X.X.X.XX.
.XXXX.X.X.X.X.X.X.XX.X.X.X.X.X.X.X.X.X.X.
.........................................
.XX.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.XX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XX.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.XX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XX.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.XX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.XX.X.X.X.XX.X.XX.X.X.X.X.X.X.X.X.X.X.X.X
.X.X.X.X.X.XXX.X.X.X.X.X.X.X.X.X.X.X.X.X.
X........................................
X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.XX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
.X.XX.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.XX.XX
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.XMX.
.X....................................X..
..X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.XX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.X...................................X...
.XX.X.X.X.X.X.X.X.X.X.X.X.X.X.XX.XX.XXXX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.XX.
.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.X.
.........................................
294
*/
#include <iostream>
#include <vector>
#include <queue>
#include <set>
using namespace std;
class graph{
private:
	int V,r,c,s,d;	
	vector<int> *list;
	vector<bool> visited;
	vector<int> distance;
	int getn(int i,int j)
	{
		return c*i+j;
	}
	void addedge(int a,int b)
	{
		list[a].push_back(b);
		list[b].push_back(a);
	}
public:
	graph(int x)
	{
		V=x;
		list = new vector<int> [x];	
		visited.assign(x,false);

		distance.assign(x,0);

	}
	~graph()
	{
		delete[] list;
	}
	void initialize (vector<string> matrix)
	{
		r = matrix.size();
		c = matrix[0].size();
		for(int i=0;i<r;i++)
		{
			for(int j=0;j<c;j++)
			{
				if(matrix[i][j]=='*' || matrix[i][j]=='M' || matrix[i][j]=='.')
				{
					int p = getn(i,j);
					// cout<<p<<endl;
					// cout<<visited.size();
			
					if(matrix[i][j]=='M')
						s=p;
					if(matrix[i][j]=='*')
						d=p;
					if(i>=1 && (matrix[i-1][j]=='*' || matrix[i-1][j]=='M' || matrix[i-1][j]=='.'))
						addedge(p,getn(i-1,j));
					if(i<r-1 && (matrix[i+1][j]=='*' || matrix[i+1][j]=='M' || matrix[i+1][j]=='.'))
						addedge(p,getn(i+1,j));
					if(j>=1 && (matrix[i][j-1]=='*' || matrix[i][j-1]=='M' || matrix[i][j-1]=='.'))
						addedge(p,getn(i,j-1));
					if(j<c-1 && (matrix[i][j+1]=='*' || matrix[i][j+1]=='M' || matrix[i][j+1]=='.'))
						addedge(p,getn(i,j+1));
				}
			}
		}
	}
	int bfs()
	{
		queue<int> q;
		q.push(s);
		visited[s]=true;
		// cout<<s<<" ";
		int flag=1;
		while(!q.empty() && flag==1)
		{
			int t = q.front();
			set<int> temp(list[t].begin(),list[t].end());
			int incr=0;
			
			if((t==s && temp.size()>1) || temp.size()>2)
				incr=1;
			q.pop();
			for(int i=0;i<list[t].size();i++)
			{
				if(!visited[list[t][i]])
				{
					visited[list[t][i]]=true;

					distance[list[t][i]]=distance[t]+incr;
					if(list[t][i]==d)
					{
						flag=0;
						break;
					}
					q.push(list[t][i]);
				}
			}
		}
		return distance[d];
	}
	void display()
	{
		for(int i=0;i<V;i++)
		{
			cout<<i<<": ";
			for(int j=0;j<list[i].size();j++)
				cout<<list[i][j]<<" ";
			cout<<endl;
		}
	}
};

int main()
{
	int t,r,c,p;
	cin>>t;
	while(t--)
	{
		cin>>r>>c;
		vector<string> matrix(r,"");
		for(int i=0;i<r;i++)
			cin>>matrix[i];
		graph g(r*c);
		g.initialize(matrix);
		// g.display();
		cin>>p;
		if(p==g.bfs())
			cout<<"Impressed"<<endl;
		else
			cout<<"Oops!"<<endl;
	}
}